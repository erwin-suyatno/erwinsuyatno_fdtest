{
  "openapi": "3.0.0",
  "info": { "title": "erwinsuyatno_fdtest API", "version": "1.0.0" },
  "paths": {
    "/api/auth/register": { "post": { "summary": "Register", "requestBody": {"required": true, "content": {"application/json": {"schema": {"type": "object", "properties": {"name":{"type":"string"},"email":{"type":"string"},"password":{"type":"string"}}, "required":["name","email","password"]}}}}, "responses": {"201": {"description": "Created"}} }},
    "/api/auth/login": { "post": { "summary": "Login", "requestBody": {"required": true, "content": {"application/json": {"schema": {"type": "object", "properties": {"email":{"type":"string"},"password":{"type":"string"}}, "required":["email","password"]}}}}, "responses": {"200": {"description": "OK"}} }},
    "/api/auth/verify": { "get": { "summary": "Verify Email", "parameters": [{"in":"query","name":"token","schema":{"type":"string"},"required":true}], "responses": {"200": {"description": "OK"}} }},
    "/api/auth/forgot": { "post": { "summary": "Forgot Password", "requestBody": {"required": true, "content": {"application/json": {"schema": {"type": "object", "properties": {"email":{"type":"string"}}, "required":["email"]}}}}, "responses": {"200": {"description": "OK"}} }},
    "/api/auth/reset": { "post": { "summary": "Reset Password", "requestBody": {"required": true, "content": {"application/json": {"schema": {"type": "object", "properties": {"token":{"type":"string"},"password":{"type":"string"}}, "required":["token","password"]}}}}, "responses": {"200": {"description": "OK"}} }},
    "/api/auth/me": { "get": { "summary": "Me", "security": [{"bearerAuth":[]}], "responses": {"200": {"description": "OK"}} }},
    "/api/users": { "get": { "summary": "List Users", "security": [{"bearerAuth":[]}], "parameters": [
      {"in":"query","name":"is_verified","schema":{"type":"boolean"}},
      {"in":"query","name":"search","schema":{"type":"string"}}
    ], "responses": {"200": {"description": "OK"}} }},
    "/api/home": { "get": { "summary": "Home", "security": [{"bearerAuth":[]}], "responses": {"200": {"description": "OK"}} }},
    "/api/public/books": { 
      "get": { 
        "summary": "Get Public Books (Landing Page)", 
        "parameters": [
          {"in":"query","name":"author","schema":{"type":"string"}},
          {"in":"query","name":"rating","schema":{"type":"integer","minimum":1,"maximum":5}},
          {"in":"query","name":"search","schema":{"type":"string"}},
          {"in":"query","name":"page","schema":{"type":"integer","minimum":1}},
          {"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100}}
        ], 
        "responses": {"200": {"description": "OK"}} 
      }
    },
    "/api/books": { 
      "post": { 
        "summary": "Create Book", 
        "security": [{"bearerAuth":[]}], 
        "requestBody": {"required": true, "content": {"application/json": {"schema": {"type": "object", "properties": {"title":{"type":"string"},"author":{"type":"string"},"description":{"type":"string"},"thumbnailUrl":{"type":"string"},"rating":{"type":"integer","minimum":1,"maximum":5}}, "required":["title","author"]}}}}, 
        "responses": {"201": {"description": "Created"}} 
      },
      "get": { 
        "summary": "List Books", 
        "security": [{"bearerAuth":[]}], 
        "parameters": [
          {"in":"query","name":"author","schema":{"type":"string"}},
          {"in":"query","name":"rating","schema":{"type":"integer","minimum":1,"maximum":5}},
          {"in":"query","name":"search","schema":{"type":"string"}},
          {"in":"query","name":"uploadedById","schema":{"type":"string"}},
          {"in":"query","name":"page","schema":{"type":"integer","minimum":1}},
          {"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100}}
        ], 
        "responses": {"200": {"description": "OK"}} 
      }
    },
    "/api/books/{id}": { 
      "get": { 
        "summary": "Get Book by ID", 
        "security": [{"bearerAuth":[]}], 
        "parameters": [{"in":"path","name":"id","schema":{"type":"string"},"required":true}], 
        "responses": {"200": {"description": "OK"}, "404": {"description": "Not Found"}} 
      },
      "put": { 
        "summary": "Update Book", 
        "security": [{"bearerAuth":[]}], 
        "parameters": [{"in":"path","name":"id","schema":{"type":"string"},"required":true}], 
        "requestBody": {"required": true, "content": {"application/json": {"schema": {"type": "object", "properties": {"title":{"type":"string"},"author":{"type":"string"},"description":{"type":"string"},"thumbnailUrl":{"type":"string"},"rating":{"type":"integer","minimum":1,"maximum":5}}}}}}, 
        "responses": {"200": {"description": "OK"}, "404": {"description": "Not Found"}} 
      },
      "delete": { 
        "summary": "Delete Book", 
        "security": [{"bearerAuth":[]}], 
        "parameters": [{"in":"path","name":"id","schema":{"type":"string"},"required":true}], 
        "responses": {"204": {"description": "No Content"}, "404": {"description": "Not Found"}} 
      }
    },
    "/api/bookings": {
      "post": {
        "summary": "Create Booking Request",
        "security": [{"bearerAuth":[]}],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "bookId": {"type": "string", "format": "uuid"},
                  "borrowDate": {"type": "string", "format": "date-time"},
                  "returnDate": {"type": "string", "format": "date-time"}
                },
                "required": ["bookId", "borrowDate", "returnDate"]
              }
            }
          }
        },
        "responses": {"201": {"description": "Created"}, "400": {"description": "Bad Request"}}
      },
      "get": {
        "summary": "Get All Bookings (Admin)",
        "security": [{"bearerAuth":[]}],
        "parameters": [
          {"in":"query","name":"userId","schema":{"type":"string","format":"uuid"}},
          {"in":"query","name":"bookId","schema":{"type":"string","format":"uuid"}},
          {"in":"query","name":"status","schema":{"type":"string","enum":["PENDING","APPROVED","REJECTED","RETURNED","OVERDUE"]}},
          {"in":"query","name":"search","schema":{"type":"string"}},
          {"in":"query","name":"page","schema":{"type":"integer","minimum":1}},
          {"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100}}
        ],
        "responses": {"200": {"description": "OK"}}
      }
    },
    "/api/bookings/my": {
      "get": {
        "summary": "Get User's Bookings",
        "security": [{"bearerAuth":[]}],
        "parameters": [
          {"in":"query","name":"status","schema":{"type":"string","enum":["PENDING","APPROVED","REJECTED","RETURNED","OVERDUE"]}},
          {"in":"query","name":"search","schema":{"type":"string"}},
          {"in":"query","name":"page","schema":{"type":"integer","minimum":1}},
          {"in":"query","name":"limit","schema":{"type":"integer","minimum":1,"maximum":100}}
        ],
        "responses": {"200": {"description": "OK"}}
      }
    },
    "/api/bookings/{id}": {
      "get": {
        "summary": "Get Booking by ID",
        "security": [{"bearerAuth":[]}],
        "parameters": [{"in":"path","name":"id","schema":{"type":"string","format":"uuid"},"required":true}],
        "responses": {"200": {"description": "OK"}, "404": {"description": "Not Found"}}
      },
      "delete": {
        "summary": "Cancel Booking",
        "security": [{"bearerAuth":[]}],
        "parameters": [{"in":"path","name":"id","schema":{"type":"string","format":"uuid"},"required":true}],
        "responses": {"204": {"description": "No Content"}, "400": {"description": "Bad Request"}, "404": {"description": "Not Found"}}
      }
    },
    "/api/bookings/{id}/approve": {
      "put": {
        "summary": "Approve Booking (Admin)",
        "security": [{"bearerAuth":[]}],
        "parameters": [{"in":"path","name":"id","schema":{"type":"string","format":"uuid"},"required":true}],
        "responses": {"200": {"description": "OK"}, "404": {"description": "Not Found"}}
      }
    },
    "/api/bookings/{id}/reject": {
      "put": {
        "summary": "Reject Booking (Admin)",
        "security": [{"bearerAuth":[]}],
        "parameters": [{"in":"path","name":"id","schema":{"type":"string","format":"uuid"},"required":true}],
        "responses": {"200": {"description": "OK"}, "404": {"description": "Not Found"}}
      }
    },
    "/api/bookings/{id}/return": {
      "put": {
        "summary": "Return Book",
        "security": [{"bearerAuth":[]}],
        "parameters": [{"in":"path","name":"id","schema":{"type":"string","format":"uuid"},"required":true}],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "actualReturnDate": {"type": "string", "format": "date-time"}
                }
              }
            }
          }
        },
        "responses": {"200": {"description": "OK"}, "400": {"description": "Bad Request"}, "404": {"description": "Not Found"}}
      }
    }
  },
  "components": { "securitySchemes": { "bearerAuth": { "type": "http", "scheme": "bearer", "bearerFormat": "JWT" } } }
}
